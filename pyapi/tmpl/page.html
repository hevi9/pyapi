{% extends "tmpl/base.html" %}


{# macro have to be ourside of the block block #}
{% macro walk(node) %}

<div id="{{ node.path }}.scope" class="scope">

{%- if node.attrs %}
<div id="{{ node.path }}.attrs" class="attrs">
{%- for subnode in node.attrs | sort(attribute="name") %}
<button id="{{subnode.path}}" class="node">{{ subnode.signature }}</button>
{%- endfor %}
</div> <!-- {{ node.path }}.attrs -->
{%- endif %}

{% if node.doc %}
<!-- {{node.path}} doc -->
<pre class="doc">{{ node.doc|e }}</pre>
{% endif %}

{%- if node.attrs %}
{%- for subnode in node.attrs | sort(attribute="name") %}
{{- walk(subnode) }}
{%- endfor %}
{%- endif %}

</div> <!-- {{ node.path }}.scope -->

{% endmacro %}

{% block content %}

<script>
function jq( myid ) {	 
    return "#" + myid.replace( /(:|\.|\[|\]|,)/g, "\\$1" );
}
$(document).ready(function(){
    $(".node").click(function(){
    	$(".scope").hide();
        var id = "";
        var sel = id + ".scope";
        console.log("show", sel);
        $(jq(sel)).show();
        for(let i of $(this).attr("id").split(".")) {
        	if(id == "") {
        		id = i;
        	} else {
        	   id += "." + i;
        	}
            var sel = id + ".scope";
            console.log("show", sel);
            $(jq(sel)).show();
        }
    });
}); 
</script>

{{ walk(root) }}


{% endblock %}
